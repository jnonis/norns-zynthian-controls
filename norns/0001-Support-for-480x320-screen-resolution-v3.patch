From 20f71f1ab3aceff328167c6602b9a9c83c2e7fda Mon Sep 17 00:00:00 2001
From: Javier Nonis <javiernonis@gmail.com>
Date: Mon, 27 Apr 2020 16:03:33 -0500
Subject: [PATCH] Support for screens with resolution of 480x320

---
 matron.sh                    | 2 +-
 matron/src/hardware/screen.c | 4 +++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/matron.sh b/matron.sh
index ba344ad4..5834d0fc 100755
--- a/matron.sh
+++ b/matron.sh
@@ -1,3 +1,3 @@
 #!/bin/bash
 
-./build/ws-wrapper/ws-wrapper ws://*:5555 ./build/matron/matron
+./build/ws-wrapper/ws-wrapper ws://*:5555 ./build/matron/matron -f/dev/fb1
diff --git a/matron/src/hardware/screen.c b/matron/src/hardware/screen.c
index 9ecdc40c..bb22be45 100644
--- a/matron/src/hardware/screen.c
+++ b/matron/src/hardware/screen.c
@@ -281,8 +281,10 @@ void screen_init(void) {
     cairo_set_font_size(cr, 8.0);
 
     // config buffer
+    cairo_scale(crfb, 3, 3);
     cairo_set_operator(crfb, CAIRO_OPERATOR_SOURCE);
-    cairo_set_source_surface(crfb,surface,0,0);
+    cairo_set_source_surface(crfb,surface,13,21);
+    cairo_pattern_set_filter(cairo_get_source(crfb), CAIRO_FILTER_FAST);
 }
 
 void screen_deinit(void) {
-- 
2.20.1

